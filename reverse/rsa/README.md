## RSA

### RSA加密基本原理

#### 加密过程

选择两个大素数p和q，计算出模数N = p * q

计算φ = (p−1) * (q−1) 即N的欧拉函数，然后选择一个e (1<e<φ)，且e和φ互质

取e的模反数为d，计算方法: e * d ≡ 1 (mod φ)

对明文A进行加密：`B≡A^e (mod n) 或 B = pow(A,e,n)`，得到的B即为密文

对密文B进行解密，`A≡B^d( mod n) 或 A = pow(B,d,n)`，得到的A即为明文


> p 和 q ：大整数N的两个因子（factor）
>
> N：大整数N，我们称之为模数（modulus）
>
> e 和 d：互为模反数的两个指数（exponent）
>
> c 和 m：分别是密文和明文，这里一般指的是一个十进制的数

一般有如下称呼：

> （N，e）：公钥
>
> （N，d）：私钥


#### 加密分析

RSA算法是一种非对称密码算法，所谓非对称，就是指该算法需要一对密钥，使用其中一个加密，则需要用另一个才能解密。

RSA的算法涉及三个参数，n、e、d。

其中，n是两个大质数p、q的积，n以二进制表示时所占用的位数，就是所谓的密钥长度。

e和d是一对相关的值，e可以任意取，但要求e与(p-1)(q-1)互质；再选择d，要求`(ed) ≡ 1(mod(p-1)×(q-1))`。

令φ = (p-1)(q-1) 上式即 `d*e = 1 mod φ 即：(d*e - 1)% φ = 0`

（n，e),(n，d)就是密钥对。其中(n，e)为公钥，(n，d)为私钥。RSA加解密的算法完全相同，设A为明文，B为密文，则：`A≡B^d( mod n); B≡A^e (mod n)`;（公钥加密体制中，一般用公钥加密，私钥解密）

e和d可以互换使用，即：

`A≡B^e (mod n)；B≡A^d( mod n);`

#### 附加解释

**同余符号 “ ≡ ”**

数论中的重要概念。给定一个正整数m，如果两个整数a和b满足（a-b）能够被m整除，即（a-b）/m得到一个整数，那么就称整数a与b对模m同余，记作a≡b(mod m)。对模m同余是整数的一个等价关系

比如26≡14(mod 12)

**互质**

公约数只有1的两个数，称为互质

**python pow() 函数**

```
x^y = pow(x,y)

x^y  mod  z = pow(x,y,z)
```
